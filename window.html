<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Parse XML with DMS Coordinates</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #fafafa; display: flex; flex-direction: column; min-height: 100vh; }
    textarea { width: 100%; height: 300px; margin-bottom: 10px; font-family: monospace; }
    button { padding: 10px 20px; margin-right: 10px; cursor: pointer; }
    #result { background: #f9f9f9; padding: 15px; border: 1px solid #ccc; margin-top: 20px; white-space: pre-wrap; font-family: monospace; flex-grow: 1; }
    #quoteBox { text-align: center; color: #666; font-style: italic; margin-top: 15px; margin-bottom: 20px; }
    .bullet { font-weight: bold; margin-right: 6px; }
    .area { color: #e6b800; }       /* Yellow */
    .line { color: #007bff; }       /* Blue */
    .circle { color: #28a745; }     /* Green */
    .coast { color: #8b4513; }      /* Brown */
    .label { color: #9b59b6; }      /* Purple */
    .userchart { color: #ff6600; font-weight: bold; } /* Orange for UserChart label */
  </style>
</head>
<body>

<h2>XML Coordinate Parser (Areas, Lines, Circles, Coast Lines, Labels, UserChart)</h2>

<textarea id="xmlInput" placeholder="Paste your XML here..."></textarea>
<br>
<button onclick="parseXML()">Parse XML</button>
<button onclick="downloadTextFile()">Download .txt</button>

<!-- âœ¨ Motivational quote now appears here -->
<div id="quoteBox"></div>

<div id="result"></div>

<script>
  let parsedOutput = '';

  // --- Random motivational quote (shown under buttons) ---
  const quotes = [
    "Keep pushing forward â€” progress is progress, no matter how small.",
    "Youâ€™re capable of more than you think.",
    "Every great achievement starts with one simple step.",
    "Stay curious. Keep learning. Keep growing.",
    "Success is built on consistency, not perfection.",
    "Small daily improvements lead to stunning results.",
    "Your effort today shapes your tomorrow.",
    "Believe you can â€” and youâ€™re already halfway there.",
    "Persistence turns goals into achievements.",
    "Every challenge is a chance to get stronger."
  ];
  document.getElementById("quoteBox").textContent = quotes[Math.floor(Math.random() * quotes.length)];

  // --- Coordinate conversion ---
  function toDM(deg, isLat) {
    const absolute = Math.abs(deg);
    const degrees = Math.floor(absolute);
    const minutes = (absolute - degrees) * 60;
    const direction = deg >= 0 ? (isLat ? "N" : "E") : (isLat ? "S" : "W");
    const degStr = degrees < 10 ? "0" + degrees : degrees.toString();
    const minStr = minutes < 10 ? "0" + minutes.toFixed(3) : minutes.toFixed(3);
    return `${degStr}Â°${minStr}â€² ${direction}`;
  }

  function parseXML() {
    const xmlString = document.getElementById('xmlInput').value;
    if (!xmlString.trim()) {
      document.getElementById('result').textContent = 'Please paste XML data first.';
      return;
    }

    try {
      const parser = new DOMParser();
      const xmlDoc = parser.parseFromString(xmlString, "application/xml");
      if (xmlDoc.getElementsByTagName("parsererror").length > 0) {
        document.getElementById('result').textContent = 'Error parsing XML. Please check the format.';
        return;
      }

      let htmlOutput = '';
      let textOutput = '';

      // ðŸŸ§ UserCharts
      const usercharts = xmlDoc.getElementsByTagName('userchart');
      if (usercharts.length > 0) {
        for (let chart of usercharts) {
          const chartName = chart.getAttribute('name') || '(No name)';
          htmlOutput += `<span class="userchart">UserChart name: ${chartName}</span>\n`;
          textOutput += `UserChart name: ${chartName}\n`;

          // Process elements inside each userchart
          processElements(chart);
        }
      } else {
        // If no userchart, just parse the whole doc normally
        processElements(xmlDoc);
      }

      function processElements(root) {
        // ðŸŸ¡ Areas
        const areas = root.getElementsByTagName('area');
        for (let area of areas) {
          const name = area.getAttribute('name') || '(No name)';
          htmlOutput += `<span class="bullet area">â€¢</span>AREA: ${name}\n`;
          textOutput += `AREA: ${name}\n`;
          for (let v of area.getElementsByTagName('vertex')) {
            const lat = parseFloat(v.getAttribute('latitude'));
            const lon = parseFloat(v.getAttribute('longitude'));
            const coord = `${toDM(lat, true)}, ${toDM(lon, false)}`;
            htmlOutput += `  ${coord}\n`;
            textOutput += `  ${coord}\n`;
          }
          htmlOutput += '\n';
          textOutput += '\n';
        }

        // ðŸ”µ Lines
        const lines = root.getElementsByTagName('line');
        for (let line of lines) {
          const name = line.getAttribute('name') || '(No name)';
          const attr = line.querySelector('attribute');
          const type = attr ? attr.getAttribute('lineType') : '(no type)';
          htmlOutput += `<span class="bullet line">â€¢</span>LINE: ${name}\n  Type: ${type}\n`;
          textOutput += `LINE: ${name}\n  Type: ${type}\n`;
          for (let v of line.getElementsByTagName('vertex')) {
            const lat = parseFloat(v.getAttribute('latitude'));
            const lon = parseFloat(v.getAttribute('longitude'));
            const coord = `${toDM(lat, true)}, ${toDM(lon, false)}`;
            htmlOutput += `  ${coord}\n`;
            textOutput += `  ${coord}\n`;
          }
          htmlOutput += '\n';
          textOutput += '\n';
        }

        // ðŸŸ¢ Circles
        const circles = root.getElementsByTagName('circle');
        for (let circle of circles) {
          const name = circle.getAttribute('name') || '(No name)';
          const attr = circle.querySelector('attribute');
          let range = attr ? attr.getAttribute('range') : '(no range)';
          if (!isNaN(range)) range = parseFloat(range).toFixed(2);
          htmlOutput += `<span class="bullet circle">â€¢</span>CIRCLE: ${name}\n  Range: ${range} NM\n`;
          textOutput += `CIRCLE: ${name}\n  Range: ${range} NM\n`;
          const v = circle.querySelector('vertex');
          if (v) {
            const lat = parseFloat(v.getAttribute('latitude'));
            const lon = parseFloat(v.getAttribute('longitude'));
            const coord = `${toDM(lat, true)}, ${toDM(lon, false)}`;
            htmlOutput += `  Center: ${coord}\n`;
            textOutput += `  Center: ${coord}\n`;
          }
          htmlOutput += '\n';
          textOutput += '\n';
        }

        // ðŸŸ¤ Coast Lines
        const coasts = root.get
